<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Farmers Market Website | Farmer Dashboard</title>
  <style>
    /* Basic Reset and Theme */
    :root {
      --primary: #104c22;
      --secondary: #207935;
      --accent: #f7fafc;
      --surface: #fff;
      --gray: #e6eaf1;
      --navbg: #f7f8fa;
      --pending: #fbf8e7;
      --pending-text: #b89939;
      --completed: #e4f8ef;
      --completed-text: #33bc7e;
      --shipping: #e7f4fa;
      --shipping-text: #258fd3;
      --active: #e8f5e9;
      --active-text: #228a1e;
      --low-stock: #fffbe8;
      --low-stock-text: #d7a63c;
      --shadow: 0 2px 12px rgba(34, 138, 30, 0.05);
      font-size:16px;
    }
    * {box-sizing:border-box; margin:0; padding:0;}
    body {
      font-family:'Segoe UI',Arial,sans-serif;
      background:var(--accent);
      color:#222;
      min-height:100vh;
      transition:background 0.3s, color 0.3s;
    }
    /* Topbar */
    header {
      background:var(--surface);
      box-shadow:var(--shadow);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:16px 34px;
      position:sticky; top:0;
      z-index:100;
    }
    .site-title {font-weight:700; font-size:1.3em;}
    .top-controls {display:flex; align-items:center; gap:14px;}
    .switch, .btn-logout {
      background:var(--gray); color:var(--primary); border:none;
      padding:7px 14px; border-radius:8px; cursor:pointer; font-weight:500;
      transition:background .2s, color .2s;
    }
    .btn-logout {background:#f44336;color:#fff;margin-left:6px;}
    .switch.active {background:var(--primary); color:var(--surface);}
    /* Tabs */
    .tabs {
      display:flex; justify-content:center; align-items:center; gap:20px;
      background:var(--navbg);
      padding:18px 0 3px;
      border-bottom:1px solid var(--gray);
    }
    .tabs button {
      background:none; border:none; cursor:pointer;
      font-size:1.07em; font-weight:500; color:var(--primary);
      padding:12px 34px 10px 34px; border-radius:12px 12px 0 0;
      transition:color .18s,background .18s;
      opacity:.7;
    }
    .tabs button.active {
      background:var(--surface);
      color:var(--secondary); font-weight:700; opacity:1;
      box-shadow:0 -2px 18px rgba(34,138,30,.04);
    }
    /* Main container */
    main {
      max-width:1100px;
      margin:0 auto;
      padding:38px 2vw 24px 2vw;
    }
    section {display:none;}
    section.active {display:block;}
    /* Cards/Stats */
    .stats-row {
      display:flex; gap:28px; flex-wrap:wrap;
      margin-bottom:30px;
    }
    .stat-card {
      background:var(--surface); padding:22px 0 18px 0;
      border-radius:15px; width:100%; max-width:320px; flex:1;
      box-shadow:var(--shadow); text-align:center;
    }
    .stat-card h2 {font-size:1em;font-weight:500;color:#667;}
    .stat-card .value {font-size:2em;font-weight:700;color:var(--primary);}
    .stat-card .note {font-size:0.94em;color:#89a77d;}
    /* Recent Orders/Orders */
    .card {background:var(--surface); border-radius:15px; box-shadow:var(--shadow);}
    .order-list, .customer-list {
      list-style:none; margin:0; padding:24px 0;
      display:flex; flex-direction:column; gap:13px;
    }
    .order-item, .customer-item {
      display:flex; align-items:center;
      justify-content:space-between; gap:16px;
      background:var(--accent); padding:12px 24px; border-radius:12px;
    }
    .order-info {flex:1;}
    .order-name {font-weight:600;}
    .order-desc, .order-customer {color:#888;font-size:0.99em;}
    .order-date {color:#aaa;font-size:0.93em; margin-left:18px;}
    .order-value {font-weight:600; margin-right:12px;}
    .badge {
      padding:6px 18px; border-radius:8px; font-size:0.98em; font-weight:600; margin-right:12px; letter-spacing:0.04em;
      display:inline-block;
    }
    .pending {background:var(--pending); color:var(--pending-text);}
    .shipping {background:var(--shipping); color:var(--shipping-text);}
    .completed {background:var(--completed); color:var(--completed-text);}
    .active {background:var(--active); color:var(--active-text);}
    .low-stock {background:var(--low-stock); color:var(--low-stock-text);}
    .order-actions {display:flex;gap:12px;}
    .btn {background:var(--primary);color:#fff; border:none;padding:9px 22px;border-radius:8px;cursor:pointer;font-weight:500;}
    .btn:hover {background:var(--secondary);}
    /* Profile and Products Pane */
    .profile-flex {display:flex;gap:28px;flex-wrap:wrap;}
    .farm-card,.prod-card {background:var(--surface);border-radius:14px;box-shadow:var(--shadow);padding:30px;flex:1;}
    .farm-card {min-width:320px;}
    .farm-header {display:flex;align-items:center;gap:22px;}
    .farm-avatar {
      width:58px; height:58px; border-radius:50%;
      background:#eaf6e4; color:var(--primary); font-size:1.13em; font-weight:700;
      display:flex; align-items:center; justify-content:center;
      margin-right:8px;
    }
    .farm-title {font-size:1.26em; font-weight:600;}
    .farm-sub {color:#888; font-size:0.97em; margin-bottom:8px;}
    .farm-info {margin:10px 0 0 0;}
    .farm-rating {color:#e9b500;font-size:1em;}
    .prod-card {min-width:340px;}
    .prod-list {list-style:none; margin:0;padding:0;}
    .prod-item {background:var(--accent);border-radius:10px;padding:18px 17px;margin-bottom:14px;display:flex;align-items:center;}
    .prod-title {font-weight:600;}
    .prod-stock {margin-left:18px;}
    .prod-status {margin-left:20px;}
    .add-btn {width:100%;background:var(--primary);color:#fff;padding:11px 0;margin-top:12px;font-weight:600;font-size:1.08em;border-radius:8px;border:none;cursor:pointer;}
    .add-btn:hover {background:var(--secondary);}
    /* Customers Table */
    .customer-list {padding:28px 0;gap:16px;}
    .customer-item {background:var(--accent);border-radius:10px;padding:17px 24px;display:flex;align-items:center;}
    .customer-avatar {width:34px;height:34px;border-radius:50%;background:#eaf6e4;color:var(--primary);font-weight:700;display:flex;align-items:center;justify-content:center;margin-right:10px;}
    .customer-main {flex:1;}
    .customer-name {font-weight:600;}
    .customer-email {font-size:0.98em;color:#888;}
    .customer-orders {margin-right:22px; font-size:1.01em;}
    .customer-spent {margin-right:22px; font-size:1.04em;font-weight:500;}
    .btn-contact {background:var(--primary);color:#fff;padding:7px 18px;border-radius:7px;border:none;font-weight:500;}
    .btn-contact:hover {background:var(--secondary);}
    /* Responsive */
    @media (max-width:900px) {
      main {padding:22px 2vw;}
      .stats-row, .profile-flex {flex-direction:column;gap:20px;}
      .farm-card, .prod-card {min-width:unset;}
    }
  </style>
</head>
<body>
  <!-- Topbar -->
  <header>
    <div class="site-title">Farmers Dashboard</div>
    <div class="top-controls">
      <span style="font-weight:600;">Welcome, Green Valley Farm</span>
      <button class="switch" id="switchDark">🌙</button>
      <button class="btn-logout" id="btnLogout">Logout</button>
    </div>
  </header>
  <!-- Tabs Navigation -->
  <nav class="tabs">
    <button class="active" onclick="showTab('dashboard',this)">Overview</button>
    <button onclick="showTab('profile',this)">Profile</button>
    <button onclick="showTab('orders',this)">Orders</button>
    <button onclick="showTab('customers',this)">Customers</button>
    <button onclick="window.location.href='sellers.html'">Add Products</button>
  </nav>
  <main>
    <!-- OVERVIEW SECTION -->
    <section id="dashboard" class="active">
      <div style="font-size:1.5em;font-weight:600;margin-bottom:9px;">Welcome, Green Valley Farm</div>
      <div style="color:#888; margin-bottom:26px;">Manage your farm business</div>
      <div class="stats-row">
        <div class="stat-card">
          <h2>Total Orders</h2>
          <div class="value">156</div>
          <div class="note">+12% from last month</div>
        </div>
        <div class="stat-card">
          <h2>Total Sales</h2>
          <div class="value">$4,235</div>
          <div class="note">+8% from last month</div>
        </div>
        <div class="stat-card">
          <h2>Active Customers</h2>
          <div class="value">43</div>
          <div class="note">+3 new this month</div>
        </div>
      </div>
      <div class="card">
        <h3 style="margin:20px 0 0 28px;">Recent Orders</h3>
        <ul class="order-list">
          <li class="order-item">
            <div class="order-info">
              <div class="order-name">John Smith <span style="color:#aaa; font-size:0.96em;">Organic Tomatoes - 5kg</span></div>
            </div>
            <span class="order-value">$25.00</span>
            <span class="badge pending">pending</span>
          </li>
          <li class="order-item">
            <div class="order-info">
              <div class="order-name">Sarah Johnson <span style="color:#aaa; font-size:0.96em;">Fresh Lettuce - 2kg</span></div>
            </div>
            <span class="order-value">$12.00</span>
            <span class="badge completed">completed</span>
          </li>
          <li class="order-item">
            <div class="order-info">
              <div class="order-name">Mike Brown <span style="color:#aaa; font-size:0.96em;">Carrots - 3kg</span></div>
            </div>
            <span class="order-value">$18.00</span>
            <span class="badge shipping">shipping</span>
          </li>
        </ul>
      </div>
    </section>
    <!-- PROFILE SECTION -->
    <section id="profile">
      <div class="profile-flex">
        <!-- Farm Info -->
        <div class="farm-card">
          <div class="farm-header">
            <div class="farm-avatar">GV</div>
            <div>
              <div class="farm-title">Green Valley Farm</div>
              <div class="farm-sub">Organic Vegetable Producer</div>
              <div class="farm-rating">★ 4.8 <span style="color:#888;">(156 reviews)</span></div>
            </div>
          </div>
          <div class="farm-info">
            <div>📍 1234 Farm Road, California, USA</div>
            <div>📞 +1 (555) 123-4567</div>
            <div>✉️ contact@greenvalleyfarm.com</div>
          </div>
          <button class="btn" style="margin-top:22px;" onclick="window.location.href='profile.html'">Edit Profile</button>
        </div>
        <!-- Products List -->
        <div class="prod-card">
          <h3 style="font-size:1.1em;margin-bottom:16px;">Products</h3>
          <ul class="prod-list">
            <li class="prod-item">
              <span class="prod-title">Organic Tomatoes</span> &nbsp;&nbsp;<span style="color:#888;">$5.00/kg</span> <span class="prod-stock" style="color:#888;">In Stock</span>
              <span class="badge active">Active</span>
            </li>
            <li class="prod-item">
              <span class="prod-title">Fresh Lettuce</span> &nbsp;&nbsp;<span style="color:#888;">$6.00/kg</span> <span class="prod-stock" style="color:#888;">In Stock</span>
              <span class="badge active">Active</span>
            </li>
            <li class="prod-item">
              <span class="prod-title">Carrots</span> &nbsp;&nbsp;<span style="color:#888;">$4.00/kg</span><span class="prod-stock" style="color:#888;">Low Stock</span>
              <span class="badge low-stock">Low Stock</span>
            </li>
          </ul>
          <button class="add-btn" onclick="window.location.href='addProduct.html'">+ Add New Product</button>
        </div>
      </div>
    </section>
    <!-- ORDERS / PRODUCT HISTORY -->
<section id="orders">
  <div class="card">
    <div id="orders"></div>

    <h3 style="margin:22px 0 0 28px;">My Product History</h3>
    <ul id="historyList" class="order-list">
      <li style="text-align:center; color:#888; list-style:none;">Loading product history...</li>
    </ul>
  </div>
</section>

    
    <!-- CUSTOMERS -->
    <section id="customers">
      <div class="card">
        <h3 style="margin:22px 0 0 28px;">Customer List</h3>
        <ul class="customer-list">
          <li class="customer-item">
            <div class="customer-avatar">J</div>
            <div class="customer-main">
              <div class="customer-name">John Smith</div>
              <div class="customer-email">john@email.com</div>
            </div>
            <div class="customer-orders">12 Orders</div>
            <div class="customer-spent">$340.00</div>
            <div style="font-size:0.97em; color:#888;">2024-06-15<br>Member Since</div>
            <button class="btn-contact" onclick="alert('Contact John Smith')">Contact</button>
          </li>
          <li class="customer-item">
            <div class="customer-avatar">S</div>
            <div class="customer-main">
              <div class="customer-name">Sarah Johnson</div>
              <div class="customer-email">sarah@email.com</div>
            </div>
            <div class="customer-orders">8 Orders</div>
            <div class="customer-spent">$215.00</div>
            <div style="font-size:0.97em; color:#888;">2024-08-20<br>Member Since</div>
            <button class="btn-contact" onclick="alert('Contact Sarah Johnson')">Contact</button>
          </li>
          <li class="customer-item">
            <div class="customer-avatar">M</div>
            <div class="customer-main">
              <div class="customer-name">Mike Brown</div>
              <div class="customer-email">mike@email.com</div>
            </div>
            <div class="customer-orders">15 Orders</div>
            <div class="customer-spent">$445.00</div>
            <div style="font-size:0.97em; color:#888;">2024-05-10<br>Member Since</div>
            <button class="btn-contact" onclick="alert('Contact Mike Brown')">Contact</button>
          </li>
        </ul>
      </div>
    </section>
  </main>
  <script>
    // Tab Navigation
    function showTab(id, btn) {
      document.querySelectorAll('.tabs button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('main > section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // Load Farmer’s Product History
async function loadHistory() {
  try {
    const res = await fetch("/my-products"); // API route should return farmer’s products
    const products = await res.json();

    const historyList = document.getElementById("historyList");
    historyList.innerHTML = "";

    if (!products.length) {
      historyList.innerHTML = "<li style='text-align:center; color:#888;'>No products added yet.</li>";
      return;
    }

    products.forEach(p => {
      const li = document.createElement("li");
      li.className = "order-item";
      li.innerHTML = `
        <div class="order-info">
          <div class="order-name">${p.name} <span style="color:#aaa; font-size:0.96em;"> - ${p.quantity}kg</span></div>
          <div class="order-desc">Price: $${p.price} | Added: ${new Date(p.createdAt).toLocaleDateString()}</div>
        </div>
        <span class="badge ${p.quantity > 0 ? "active" : "low-stock"}">
          ${p.quantity > 0 ? "Active" : "Out of Stock"}
        </span>
        <div class="order-actions">
          <button class="btn" onclick="deleteProduct('${p._id}')">Delete</button>
        </div>
      `;
      historyList.appendChild(li);
    });
  } catch (err) {
    console.error("Error loading product history:", err);
  }
}

// Delete product (if farmer has no stock)
async function deleteProduct(id) {
  if (!confirm("Are you sure you want to delete this product?")) return;
  try {
    await fetch(`/products/${id}`, { method: "DELETE" });
    alert("Product deleted successfully!");
    loadHistory(); // reload list
  } catch (err) {
    console.error("Error deleting product:", err);
  }
}

// Load history when Orders tab is opened
document.querySelector("button[onclick=\"showTab('orders',this)\"]").addEventListener("click", loadHistory);


    // Dark Mode Toggle
    document.getElementById('switchDark').onclick = function() {
      document.body.classList.toggle('dark-mode');
      if(document.body.classList.contains('dark-mode')) {
        document.body.style.background="#131a1d";
      } else {
        document.body.style.background="";
      }
    }
    // Logout Action
    document.getElementById('btnLogout').onclick = function() {
      alert('Logout successful.');
      window.location.href = 'login.html';
    }
  </script>
</body>
</html>
z