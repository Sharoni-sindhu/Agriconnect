<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile | Green Fields</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      /* ðŸŒ¾ Agriculture-inspired color palette */
      --primary: #6b4226;       /* earthy brown */
      --secondary: #a3c14a;     /* fresh crop green */
      --accent: #fffaf0;        /* light warm cream */
      --surface: #ffffff;       /* white for cards */
      --highlight: #ffb347;     /* harvest orange for accents */
      --shadow: 0 2px 12px rgba(107, 66, 38, 0.1);
      --radius: 12px;
      --text: #3b2f2f;
      --background: #fffaf0;
    }

    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--background);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      transition: 0.3s;
    }
    body.dark-mode {
      background:#2b1d0e;
      color:#f3e8d1;
    }

    /* Sidebar */
    aside.sidebar {
      width: 250px;
      background: var(--primary);
      color: #fffaf0;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 24px;
      box-shadow: var(--shadow);
    }
    aside.sidebar h2 {
      font-size: 1.4em;
      margin-bottom: 24px;
      color: var(--highlight);
    }
    aside.sidebar a {
      display: block;
      padding: 12px 16px;
      color: #fffaf0;
      text-decoration: none;
      font-weight: 500;
      border-radius: 8px;
      margin-bottom: 6px;
      transition: background 0.2s ease-in-out;
    }
    aside.sidebar a:hover,
    aside.sidebar a.active {
      background: var(--secondary);
      color: #2f2f1f;
    }

    /* Main layout */
    .main-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: var(--accent);
    }

    header {
      background: var(--surface);
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: var(--shadow);
      border-bottom: 3px solid var(--highlight);
    }

    header strong {
      color: var(--primary);
      font-size: 1.1em;
    }

    header .top-controls button {
      margin-left: 10px;
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-weight: 500;
      background: var(--highlight);
      color: #fff;
      transition: 0.3s;
    }

    header .top-controls button:hover {
      background: #f9a825;
    }

    main {
      flex: 1;
      padding: 32px;
      max-width: 900px;
      margin: auto;
    }

    /* Profile Card */
    .profile-container {
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 32px;
      transition: 0.3s;
    }

    .profile-container:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(107, 66, 38, 0.12);
    }

    h1 {
      color: var(--primary);
      margin-bottom: 6px;
    }

    #role-label {
      background: var(--secondary);
      color: #fff;
      padding: 5px 15px;
      border-radius: 15px;
      display: inline-block;
      margin-top: 6px;
      font-weight: 500;
    }

    h2 {
      color: var(--secondary);
      margin-top: 25px;
      margin-bottom: 10px;
      font-size: 1.2em;
    }

    section { margin-bottom: 24px; }

    .profile-details table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
      border-radius: 8px;
      overflow: hidden;
    }

    .profile-details th,
    .profile-details td {
      padding: 10px 14px;
      text-align: left;
    }

    .profile-details th {
      background: var(--accent);
      color: var(--primary);
      width: 180px;
    }

    .profile-details td {
      background: var(--surface);
      color: var(--text);
    }

    .profile-details tr:not(:last-child) {
      border-bottom: 1px solid var(--shadow);
    }

    /* Buttons */
    .action-btn {
      padding: 10px 20px;
      margin: 3px;
      background: var(--secondary);
      color: #fff;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s ease-in-out;
    }

    .action-btn:hover {
      background: #7fb85a;
    }

    .profile-actions {
      margin-top: 25px;
      text-align: right;
    }

    /* Form */
    form input,
    form textarea,
    form select {
      width: 100%;
      padding: 10px 12px;
      margin: 8px 0 15px;
      border: 1px solid var(--secondary);
      border-radius: 6px;
      background: var(--accent);
      font-size: 1em;
    }

    form label {
      font-weight: 600;
      color: var(--primary);
      display: block;
      margin-top: 8px;
    }

    .profile-image {
      text-align: center;
      margin-bottom: 18px;
    }

    .profile-image img {
      width: 130px;
      height: 130px;
      object-fit: cover;
      border-radius: 50%;
      border: 4px solid var(--secondary);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .hidden { display: none; }

    @media (max-width: 900px) {
      aside.sidebar { width: 70px; padding: 14px; }
      aside.sidebar h2 { display: none; }
      main { padding: 20px; }
      .profile-container { padding: 22px; }
    }
  </style>
</head>

<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div>
      <h2>ðŸŒ¾ Green Fields</h2>
      <nav>
        <a href="farmers.html">Home</a>
        <a href="profile.html" class="active">Profile</a>
        <a href="farmer-history.html">Orders</a>
        <a href="sellers.html">Add Product</a>
      </nav>
    </div>
    <div><small>&copy; 2025 Green Valley Farm</small></div>
  </aside>

  <div class="main-area">
    <header>
      <div><strong>Profile Dashboard</strong></div>
      <div class="top-controls">
        
        <button onclick="window.location.href='login.html'">Logout</button>
      </div>
    </header>

    <main>
      <div class="profile-container">
        <header style="text-align:center;">
          <h1>Your Profile</h1>
          <p id="role-label">Role: <span id="profile-role">Not set</span></p>
        </header>

        <!-- Profile Form -->
        <section id="profile-form-section">
          <h2>Enter Your Details</h2>

          <div class="profile-image">
            <img id="preview-image" alt="Profile Image">
          </div>

          <form id="profile-form">
            <label>Upload Profile Image:</label>
            <input type="file" id="input-image" accept="image/*">

            <label>Name:</label>
            <input type="text" id="input-name" required>

            <label>Role:</label>
            <select id="input-role" required>
              <option value="">Select role</option>
              <option value="Farmer">Farmer</option>
              <option value="Buyer">Buyer</option>
              <option value="Both">Both</option>
            </select>

            <label>Location:</label>
            <input type="text" id="input-location">

            <label>Summary:</label>
            <textarea id="input-summary" rows="3"></textarea>

            <label>Products/Interests:</label>
            <input type="text" id="input-products">

            <label>Community/FPO:</label>
            <input type="text" id="input-fpo">

            <label>Certifications:</label>
            <input type="text" id="input-cert">

            <label>Preferred Payment:</label>
            <input type="text" id="input-payment">

            <label>Languages:</label>
            <input type="text" id="input-languages">

            <label>Contact:</label>
            <input type="email" id="input-contact">

            <button type="submit" class="action-btn">Save Profile</button>
          </form>
        </section>

        <!-- Profile Display -->
        <section id="profile-display-section" class="hidden">
          <div class="profile-image">
            <img id="display-image" src="default.png" alt="Profile Image">
          </div>

          <h2>Profile Summary</h2>
          <p id="display-summary"></p>

          <h2>Key Details</h2>
          <div class="profile-details">
            <table>
              <tr><th>Name</th><td id="display-name"></td></tr>
              <tr><th>Location</th><td id="display-location"></td></tr>
              <tr><th>Products/Interests</th><td id="display-products"></td></tr>
              <tr><th>Community/FPO</th><td id="display-fpo"></td></tr>
              <tr><th>Certifications</th><td id="display-cert"></td></tr>
              <tr><th>Preferred Payment</th><td id="display-payment"></td></tr>
              <tr><th>Languages</th><td id="display-languages"></td></tr>
              <tr><th>Contact</th><td id="display-contact"></td></tr>
            </table>
          </div>

          <div class="profile-actions">
            <button id="edit-profile" class="action-btn">Edit Profile</button>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    const username = localStorage.getItem("loggedInUser");

    if (!username) {
      alert("Please log in first!");
      window.location.href = "login.html";
    }

    const profileForm = document.getElementById("profile-form");
    const formSection = document.getElementById("profile-form-section");
    const displaySection = document.getElementById("profile-display-section");
    const profileRole = document.getElementById("profile-role");
    const inputImage = document.getElementById("input-image");
    const previewImage = document.getElementById("preview-image");
    const displayImage = document.getElementById("display-image");

    inputImage.addEventListener("change", function () {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          previewImage.src = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    profileForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const profileData = {
        username,
        name: document.getElementById("input-name").value,
        role: document.getElementById("input-role").value,
        location: document.getElementById("input-location").value,
        summary: document.getElementById("input-summary").value,
        products: document.getElementById("input-products").value,
        fpo: document.getElementById("input-fpo").value,
        cert: document.getElementById("input-cert").value,
        payment: document.getElementById("input-payment").value,
        languages: document.getElementById("input-languages").value,
        contact: document.getElementById("input-contact").value,
        image: previewImage.src || "default.png"
      };
      localStorage.setItem(`profile_${username}`, JSON.stringify(profileData));
      alert("âœ… Profile saved successfully!");
      showProfile(profileData);
    });

    window.addEventListener("DOMContentLoaded", () => {
      const savedProfile = localStorage.getItem(`profile_${username}`);
      if (savedProfile) {
        const profile = JSON.parse(savedProfile);
        showProfile(profile);
      }
    });

    function showProfile(profile) {
      document.getElementById("display-name").innerText = profile.name;
      document.getElementById("display-location").innerText = profile.location;
      document.getElementById("display-summary").innerText = profile.summary;
      document.getElementById("display-products").innerText = profile.products;
      document.getElementById("display-fpo").innerText = profile.fpo;
      document.getElementById("display-cert").innerText = profile.cert;
      document.getElementById("display-payment").innerText = profile.payment;
      document.getElementById("display-languages").innerText = profile.languages;
      document.getElementById("display-contact").innerText = profile.contact;
      displayImage.src = profile.image || "default.png";
      profileRole.innerText = profile.role;
      formSection.classList.add("hidden");
      displaySection.classList.remove("hidden");
    }

    document.getElementById("edit-profile").addEventListener("click", () => {
      formSection.classList.remove("hidden");
      displaySection.classList.add("hidden");
    });

  
  </script>
</body>
</html>